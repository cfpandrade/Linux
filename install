#!/bin/bash
clear
# Update/Upgrade
echo "$(tput setaf 5)---------------------------------"
echo "Updating and Upgrading the system"
echo "---------------------------------$(tput sgr 0)"
sudo apt update
sudo apt -y upgrade
echo
echo
echo

# Install requirements
echo "$(tput setaf 5)------------------------"
echo 'Installing requirementes'
echo "------------------------$(tput sgr 0)"

sudo apt -y install bat zsh git vim xcb fonts-powerline tmux zsh-autosuggestions mawk sed htop neovim ncdu
echo
echo
echo

# # Install Polybar
# echo "$(tput setaf 5)---------------"
# echo 'Installing Polybar'
# echo "---------------$(tput sgr 0)"
# sudo apt -y install i3 ccache make cmake-data pkg-config python3-sphinx libcairo2-dev libxcb1-dev libxcb-util0-dev libxcb-randr0-dev libxcb-composite0-dev python3-xcbgen xcb-proto libxcb-image0-dev libxcb-icccm4-dev libxcb-xkb-dev libxcb-xrm-dev libxcb-cursor-dev libasound2-dev libpulse-dev libjsoncpp-dev libmpdclient-dev libcurl4-openssl-dev libnl-genl-3-dev libuv1-dev
# git clone --recursive https://github.com/polybar/polybar ~/Downloads/polybar
# cd ~/Downloads/polybar
# mkdir build
# cd build
# cmake ..
# make -j $(nproc)
# sudo make install

# # Polybar Colors
# git clone https://github.com/VaughnValle/blue-sky.git ~/Downloads/blue-sky
# mkdir ~/.config/polybar
# cd ~/Downloads/blue-sky/polybar/
# cp * -r ~/.config/polybar
# #echo '~/.config/polybar/./launch.sh' >> ~/.config/bspwm/bspwmrc
# sudo cp ~/Downloads/blue-sky/polybar/fonts/* /usr/share/fonts/truetype
# fc-cache -v
# mv ~/.config/polybar/config ~/.config/polybar/config.ini

# # Install Picom
# echo "$(tput setaf 5)---------------"
# echo 'Installing Picom'
# echo "---------------$(tput sgr 0)"
# sudo apt update
# sudo apt -y install meson libxext-dev libxcb1-dev libxcb-damage0-dev libxcb-xfixes0-dev libxcb-shape0-dev libxcb-render-util0-dev libxcb-render0-dev libxcb-randr0-dev libxcb-composite0-dev libxcb-present-dev libxcb-xinerama0-dev libpixman-1-dev libdbus-1-dev libconfig-dev libgl1-mesa-dev libpcre2-dev libevdev-dev uthash-dev libev-dev libx11-xcb-dev libxcb-glx0-dev

# git clone https://github.com/ibhagwan/picom.git ~/Downloads/picom
# cd ~/Downloads/picom
# git submodule update --init --recursive
# meson --buildtype=release . build
# ninja -C build
# sudo ninja -C build install


# Install apps
echo "$(tput setaf 5)---------------"
echo 'Installing apps'
echo "---------------$(tput sgr 0)"
sudo dpkg -i ~/Linux/apps/bat_0.18.3_amd64.deb
sudo dpkg -i ~/Linux/apps/lsd_0.20.1_amd64.deb
echo
echo
# sudo apt-mark hold bat
echo

# Install fonts
echo "$(tput setaf 5)----------------"
echo 'Installing fonts'
echo "----------------$(tput sgr 0)"
mkdir ~/.fonts
cp -r ./fonts/* ~/.fonts/
fc-cache -f -v
echo
echo
echo

# ZSH conf
echo "$(tput setaf 5)-----------------"
echo 'ZSH Configuration'
echo "-----------------$(tput sgr 0)"
cp .zshrc ~
sudo mkdir /usr/share/zsh
sudo cp -r ./zsh/* /usr/share/zsh/
echo "$(tput setaf 1)------"
echo " Done "
echo "------$(tput sgr 0)"
echo
echo
echo

# Installing whichSystem
echo "$(tput setaf 5)----------------------"
echo 'Installing whichSystem'
echo "----------------------$(tput sgr 0)"
sudo cp ./apps/whichSystem.py /usr/bin/
sudo chmod +x /usr/bin/whichSystem.py
echo 
echo " whichSystem Installed "
echo
echo

#ZSH as default
echo "$(tput setaf 5)-------------------------------"
echo 'Making ZSH default for everyone'
echo "-------------------------------$(tput sgr 0)"
sudo usermod --shell /usr/bin/zsh $USER
sudo usermod --shell /usr/bin/zsh root

# Solve issues when you migrate from root to a lower privileged user
echo "$(tput setaf 5)-------------------------------------------------------"
echo 'Solving an issue when migrate from root to a lower user'
echo "-------------------------------------------------------$(tput sgr 0)"
sudo setfacl -m u:$USER:rwx
echo "$(tput setaf 1)--------"
echo " Solved "
echo "--------$(tput sgr 0)"

#Powerlevel10k
echo "$(tput setaf 5)---------------"
echo " PowerLevel10k "
echo "---------------$(tput sgr 0)"
sudo git clone --depth=1 https://github.com/romkatv/powerlevel10k.git /usr/bin/powerlevel10k

# Install FZF
echo "$(tput setaf 5)-------------"
echo " Install FZF "
echo "-------------$(tput sgr 0)"

git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf
~/.fzf/install --key-bindings --completion --all 

# Oh My Tmux
echo "$(tput setaf 5)--------------------"
echo " Install Oh-My-Tmux "
echo "--------------------$(tput sgr 0)"
cd
git clone https://github.com/gpakosz/.tmux.git
ln -s -f .tmux/.tmux.conf
cp .tmux/.tmux.conf.local .

echo
echo
echo
echo
echo
echo

clear
echo "$(tput setaf 5)--------------------"
echo "Cleaning the install files"
echo "--------------------$(tput sgr 0)"
sudo rm -r ~/Downloads/polybar
sudo rm -r ~/Downloads/blue-sky
sudo rm -r ~/Downloads/picom




echo "$(tput setaf 5)--------------------"
echo "Carlos Perez Andrade"
echo "--------------------$(tput sgr 0)"
